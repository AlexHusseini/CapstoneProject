{% extends "base.html" %}
{% block content %}
{% if closed %}
  <h2>Round Closed</h2>
  <p>This evaluation round is closed. No further submissions are accepted.</p>
{% elif submitted %}
  <h2>Thank you!</h2>
  <p>Your evaluation has been recorded.</p>
{% else %}
  <h2>Peer Evaluation</h2>
  <p><b>Round:</b> {{ t.eval_round.name }}</p>
  <p><b>Evaluator:</b> {{ t.evaluator.full_name }} ({{ t.evaluator.email }})</p>
  <p><b>Evaluatee:</b> {{ t.evaluatee.full_name }} ({{ t.evaluatee.email }})</p>
  <hr>
  <form method="post">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
    <p style="margin: 6px 0 10px 0;"><small>Use the 1–{{ rubric.items[0].max_score if rubric.items and rubric.items[0].max_score else 5 }} scale and follow each criterion’s description for what <b>1</b> and <b>{{ rubric.items[0].max_score if rubric.items and rubric.items[0].max_score else 5 }}</b> mean.</small></p>
    <table class="table">
      <tr><th>Criterion</th><th>Description</th><th>Score</th></tr>
      {% for item in rubric.items %}
      <tr>
        <td>{{ item.criterion }}</td>
        <td>{{ item.description or "" }}</td>
        <td>
          <div role="radiogroup" aria-label="{{ item.criterion }} score">
            {% for s in range(1, item.max_score + 1) %}
              <label style="margin-right:10px;">
                <input type="radio" name="criterion_{{ item.id }}" value="{{ s }}" {% if s == 1 %}required{% endif %}> {{ s }}
              </label>
            {% endfor %}
            <small>1 - {{ item.max_score }}</small>
          </div>
        </td>
      </tr>
      {% endfor %}
    </table>
    <button type="submit">Submit</button>
  </form>
{% endif %}
{% endblock %}